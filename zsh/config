fpath=($DOTFILES/zsh/functions $fpath)
autoload -U $DOTFILES/zsh/functions/*(:t)

##
# Initialize colors
##
autoload -U colors
colors

##
# Prompt
##
HOSTNAME_LABEL="%B%F{green}%n@%m%f"
if [ -n "$SSH_CONNECTION" ]; then
  HOSTNAME_LABEL="%S$HOSTNAME_LABEL%s"
fi

PROMPT='%0(?||%B%F{red}%? %b)$HOSTNAME_LABEL %F{cyan}%(2~.%~.%/)%b%f$'

# Add git information to prompt
if [ $git_installed -eq 0 ]; then
  source $DOTFILES/zsh/git-prompt/zshrc.sh
  PROMPT="$PROMPT(git_super_status)"
fi

export PROMPT="$PROMPT
%B%F{yellow}%#%b%f "

##
# Options
##
HISTFILE=~/.zsh_history
HISTSIZE=1000
SAVEHIST=1000
REPORTTIME=10 # print elapsed time when more than 10 seconds

setopt APPEND_HISTORY # adds history
setopt AUTO_CD
setopt COMPLETE_IN_WORD
setopt EXTENDED_HISTORY # add timestamps to history
setopt HIST_IGNORE_ALL_DUPS  # don't record dupes in history
setopt HIST_REDUCE_BLANKS
setopt HIST_VERIFY
setopt IGNORE_EOF
setopt INC_APPEND_HISTORY SHARE_HISTORY  # adds history incrementally and share it across sessions
setopt LOCAL_OPTIONS # allow functions to have local options
setopt LOCAL_TRAPS # allow functions to have local traps
setopt NO_BG_NICE # don't nice background tasks
setopt NO_HUP
setopt NO_LIST_BEEP
setopt PROMPT_SUBST
setopt SHARE_HISTORY # share history between sessions ???

zle -N newtab

##
# Bindings
##
bindkey '^[^[[D' backward-word
bindkey '^[^[[C' forward-word
bindkey '^[[5D' beginning-of-line
bindkey '^[[5C' end-of-line
bindkey '^[[3~' delete-char
bindkey '^[^N' newtab
bindkey '^?' backward-delete-char
bindkey '^f'  history-incremental-search-backward

bindkey '^[[H' beginning-of-line
bindkey '^[[F' end-of-line
case $TERM in (xterm*)
     bindkey '\eOH' beginning-of-line
     bindkey '\eOF' end-of-line
esac

##
# completion
##
autoload -U compinit
compinit

# matches case insensitive for lowercase
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Z}'

# pasting with tabs doesn't perform completion
zstyle ':completion:*' insert-tab pending
