##
# Determine whether or not some programs
# are installed.
##
which emacsclient > /dev/null
emacsclient_installed=$?

# Sometimes I'm on a server that doesn't have git
# installed so I curl the dotfiles tarball. Check
# so things that depend on git can be disabled.
which git > /dev/null
git_installed=$?

##
# rbenv installed?
##
which rbenv > /dev/null
rbenv_installed=$?

if [ $rbenv_installed -eq 0 ]; then
    path_prefix='$prepend_path:$HOME/.rbenv/bin'
    alias rb='rbenv'
    eval "$(rbenv init -)"
fi

##
# path
##
export PATH="$DOTFILES/bin:$prepend_path:$PATH"

##
# Platform specific
##
case `uname` in
    (Darwin)
        export JAVA_HOME='/Library/Java/Home'
        EDITOR='emacsclient --alternate-editor=mate'

        alias bu='brew update'
        alias bout='brew outdated'
        alias bup='brew upgrade'

        vmrun="/Applications/VMware\ Fusion.app/Contents/Library/vmrun"

        ##
        # vmware
        ##
        vmstart() { $vmrun start $1 nogui }

        alias vmstop="$vmrun stop"
        alias vmls="$vmrun list"

        ;;
    (SunOS)
        export TERM='xterm'
        ;;
    (*)
        if [ $emacsclient_installed -eq 0 ]; then
            EDITOR="emacsclient --alternate-editor=vim"
        else
            which mg > /dev/null
            mg_installed=$?

            if [ $mg_installed -eq 0 ]; then
                EDITOR='mg'
            else
                EDITOR='vim'
            fi
        fi
        ;;
esac

export EDITOR
export SVN_EDITOR=$EDITOR
export GIT_EDITOR=$EDITOR

export MANPATH="/usr/local/man:/usr/local/git/man:$MANPATH"
export DEV_PATH="$HOME/dev"
export HOME_DEV_PATH="$HOME/dev/h"
export WORK_DEV_PATH="$HOME/dev/w"
export OSS_DEV_PATH="$HOME/dev/oss"
export CDPATH=":$WORK_DEV_PATH:$HOME_DEV_PATH:$OSS_DEV_PATH:$DEV_PATH:$HOME:$CDPATH"
export NODE_PATH="/usr/local/lib/node_modules"

##
# aliases
##
alias t=touch
alias ..='cd ..'
alias e="$EDITOR --no-wait"
alias grep='grep --color'
alias sha256='openssl dgst -sha256'

# ls
alias ls="ls -F"
alias l="ls -lAh"
alias ll="ls -l"
alias la='ls -A'
alias lt='ls -lt'

# git
alias gai='git add -i'
alias gap='git add -p'
alias gb='git branch'
alias gc='git commit'
alias gd='git diff'
alias gdc='git diff --cached'
alias gf='git fetch'
alias gl='git log --pretty=oneline --abbrev-commit --graph --decorate'
alias gl2="git log --graph --pretty=format':%C(yellow)%h%Cblue%d%Creset %s %C(white) %an, %ar%Creset'"
alias gp='git push'
alias s='git status --short'

# tmux
alias tls='tmux list-sessions'
alias ta='tmux attach -t '

# ruby
alias bi='bundle install'
alias gemin='gem install'
alias gemun='gem uninstall'
alias gempurge='gem list | cut -d" " -f1 | xargs gem uninstall -aIx'
